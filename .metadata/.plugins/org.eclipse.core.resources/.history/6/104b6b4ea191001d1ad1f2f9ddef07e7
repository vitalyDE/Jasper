<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.2.0.final using JasperReports Library version 6.2.0  -->
<!-- 2023-01-11T16:15:50 -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="stat_2_2" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="802" leftMargin="20" rightMargin="20" topMargin="10" bottomMargin="10" isIgnorePagination="true" uuid="4e4352f6-4aa8-47ca-9900-bfec8f7fe673">
	<property name="net.sf.jasperreports.print.create.bookmarks" value="false"/>
	<property name="com.jaspersoft.studio.unit." value="pixel"/>
	<property name="net.sf.jasperreports.export.xls.one.page.per.sheet" value="true"/>
	<property name="net.sf.jasperreports.export.xls.white.page.background" value="false"/>
	<property name="net.sf.jasperreports.export.xls.remove.empty.space.between.rows" value="false"/>
	<property name="net.sf.jasperreports.export.xls.remove.empty.space.between.columns" value="false"/>
	<property name="net.sf.jasperreports.export.xls.detect.cell.type" value="true"/>
	<property name="net.sf.jasperreports.exports.xls.font.size.fix.enabled" value="false"/>
	<property name="net.sf.jasperreports.export.xls.force.page.breaks" value="true"/>
	<property name="net.sf.jasperreports.page.break.no.pagination" value="apply"/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="One Empty Record"/>
	<style name="Table_TH" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table_CH" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table_TD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab_CH" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab_CG" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab_CT" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab_CD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<subDataset name="PARAMETERS_LIST" uuid="0432a849-4e5f-49b6-bd26-b107c6f6f1e2">
		<property name="com.jaspersoft.studio.data.defaultdataadapter" value="One Empty Record"/>
		<parameter name="REPORT_PARAMETERS_LIST" class="java.lang.String"/>
		<queryString language="plsql">
			<![CDATA[SELECT unnest AS parameter
  FROM unnest(string_to_array($P{REPORT_PARAMETERS_LIST}, ';'))]]>
		</queryString>
		<field name="PARAMETER" class="java.lang.String"/>
	</subDataset>
	<subDataset name="SRV_TBL_LDEP_PLACE" uuid="390adceb-40b6-4a13-b9c6-e09948cecae4">
		<property name="com.jaspersoft.studio.data.defaultdataadapter" value="One Empty Record"/>
		<parameter name="DATE_FROM" class="java.lang.String"/>
		<parameter name="DATE_TO" class="java.lang.String"/>
		<parameter name="DEP_ID" class="java.lang.String"/>
		<parameter name="CUSTOMER_IDS" class="java.lang.String"/>
		<parameter name="TRANSPOSE" class="java.lang.String"/>
		<parameter name="DEPARTMENT_IDS" class="java.lang.String"/>
		<parameter name="NO_DEPARTMENT" class="java.lang.String"/>
		<parameter name="NO_CUSTDEP" class="java.lang.String"/>
		<parameter name="NO_REJECT" class="java.lang.String"/>
		<parameter name="SEX" class="java.lang.String"/>
		<parameter name="AGE_FROM" class="java.lang.String"/>
		<parameter name="AGE_TO" class="java.lang.String"/>
		<parameter name="SRV" class="java.lang.String"/>
		<parameter name="QLTY" class="java.lang.String"/>
		<parameter name="H" class="java.lang.String"/>
		<parameter name="L" class="java.lang.String"/>
		<queryString language="plsql">
			<![CDATA[WITH reject as (
select distinct oi.id
from lab.order_info oi
join lab.orderworkflow owf on owf.order_id = oi.id and oi.root_id is not null
join lab.result res on res.orderworkflow_id = owf.id and res.active_status = 1
join lab.workresult wr on wr.id = res.workresult_id and wr.code ilike 'REJECT'
join lab.result_value rv on rv.result_id = res.id and rv.active_status = 1 and rv.value is not null
where $P{NO_REJECT} = '1'
)
,mwrk as (
SELECT id
FROM lab.lu
WHERE tag = 16
AND code NOT IN (1,3,4)
)
,qlty as 
(SELECT res.orderworkflow_id
		   FROM lab.result res
		   JOIN lab.result_value rv ON rv.result_id = res.id
		  WHERE rv.active_status = 1
			AND coalesce(rv.deny_print_status, 0) = 0
			AND case when $P{QLTY} = '1' then lower(rv.value) LIKE 'обнар%'
					 when $P{QLTY} = '2' then lower(rv.value) LIKE 'положител%'
					 when $P{QLTY} = '3' then lower(rv.value) LIKE 'сомнител%'
					 else false end
)
,quantity as 
(SELECT t.orderworkflow_id from (
		   select res.orderworkflow_id
		   		  , cast(rtrim(rv.value) as float) as t_value
		   		  , cast((COALESCE($P{H}, '0')) as float) AS top
     			  , cast((COALESCE($P{L}, '0')) as float) AS bot
		   FROM lab.result res
		   JOIN lab.result_value rv ON rv.result_id = res.id
		  WHERE rv.active_status = 1
			AND coalesce(rv.deny_print_status, 0) = 0
			AND rv.value ~ '^[+-]?\d+([.,]\d+)?(e[+-]?\d+)?$'
			)t
	WHERE(case when top !=0 AND bot = 0     then t_value >= top
			when top = 0 AND bot !=0   then  t_value <= bot
			when top = 0 AND bot = 0   then false 
			when top <= bot  					then  t_value >= top AND t_value <= bot
			when top >= bot  					then t_value >= top OR t_value <= bot
			else false end)
			
)
,t AS (
    SELECT srv.code                                               AS srv_sort
         , coalesce(srv.lab_short_text, srv.print_text, srv.text) AS srv_name
, coalesce(cust_r.sortcode,cust.sortcode, 0)::VARCHAR AS cust_sort
, coalesce(cust_r.shorttext,cust_r.text,cust.shorttext,cust.text,'Прочие')::VARCHAR as cust_name
         , count(DISTINCT oi.id)                                  AS cnt
      FROM lab.research r
	  JOIN med.patient p ON p.keyid = r.patient_id AND ($P{SEX} IS NULL OR  p.sex = ANY (string_to_array($P{SEX}, ',')::BIGINT[]))
															AND ($P{AGE_FROM} IS NULL OR $P{AGE_TO} IS NULL OR med.gsp_get_age_full_years(p.birthdate, current_date) between $P{AGE_FROM}::BIGINT and $P{AGE_TO}::BIGINT)
      JOIN lab.order_info oi ON oi.research_id = r.id AND ($P{SRV} IS NULL OR  oi.srvdep_id = ANY (string_to_array($P{SRV}, ',')::BIGINT[]))
      JOIN med.srvdep srv ON srv.keyid = oi.srvdep_id
      JOIN lab.orderworkflow owf ON owf.order_id = oi.id
      JOIN lab.workflow wf ON wf.id = owf.workflow_id
      JOIN lab.work w ON w.id = wf.work_id
/* Переносим наверх проверку на неизмерительные работы*/
      JOIN mwrk ON mwrk.id = w.typ_id
      JOIN lab.workplace wp ON wp.id = w.workplace_id
      LEFT JOIN lab.lu cust ON cust.id = r.external_customer_id
      /* Забраковка */
      LEFT JOIN reject rej ON rej.id = oi.id and $P{NO_REJECT} = '1'
      /* Рутовый заказчик, если есть root_id //20221011,ak */
      LEFT JOIN lab.lu cust_r ON cust_r.id = cust.root_id and $P{NO_CUSTDEP} = '1'
     WHERE r.status IN ('A','R','F')
       AND oi.result_status IN (1,2)
  	   AND oi.check_status IN (1,2)
 	   AND owf.result_status IN (1,2)
  	   AND owf.check_status IN (1,2)
/* Заказчики */
       AND ($P{CUSTOMER_IDS} IS NULL OR
            r.external_customer_id = ANY (string_to_array($P{CUSTOMER_IDS}, ', ')::BIGINT[]))
/* По дате доставки, если не заполнено - по дате взятия //20221011,ak */
       AND date_trunc('day', coalesce(r.delivery_date,r.collectdate)) BETWEEN to_date($P{DATE_FROM}, 'yyyy-mm-dd hh24:mi:ss') AND coalesce(
         to_date($P{DATE_TO}, 'yyyy-mm-dd hh24:mi:ss'), current_date)
/* Флаг не разбивать по отделам //20221011,ak */
       AND (
                  (nullif($P{NO_DEPARTMENT},'0') IS NULL AND wp.place_id = $P{DEP_ID}::BIGINT )
                  OR (nullif($P{NO_DEPARTMENT},'0') IS NULL AND wp.place_id IS NULL AND $P{DEP_ID} IS NULL)
                  OR ($P{NO_DEPARTMENT} = '1' AND ($P{DEPARTMENT_IDS} IS NULL OR wp.place_id = ANY (string_to_array($P{DEPARTMENT_IDS}, ',')::BIGINT[])))
                 )
/* Исключение забраковки //20221011,ak */
     AND (nullif($P{NO_REJECT},'0') is null
                OR ($P{NO_REJECT} = '1' and rej.id is null)
               )
/*Фильтруем результаты по значению vp 20230111 */
	  AND (exists (select 1 from qlty ql where ql.orderworkflow_id = owf.id) OR  $P{QLTY} IS NULL)
	  AND (exists (select 1 from quantity qn where qn.orderworkflow_id = owf.id) OR ($P{L} IS NULL AND $P{H} IS NULL))

     GROUP BY srv_sort, srv_name, cust_sort, cust_name
  )
SELECT CASE WHEN $P{TRANSPOSE} = '1' THEN srv_sort ELSE cust_sort END AS col_sort
     , CASE WHEN $P{TRANSPOSE} = '1' THEN srv_name ELSE cust_name END AS col_name
     , CASE WHEN $P{TRANSPOSE} = '1' THEN cust_sort ELSE srv_sort END AS row_sort
     , CASE WHEN $P{TRANSPOSE} = '1' THEN cust_name ELSE srv_name END AS row_name
     , cnt
  FROM t
 ORDER BY row_sort, row_name, col_sort, col_name]]>
		</queryString>
		<field name="ROW_SORT" class="java.lang.String"/>
		<field name="ROW_NAME" class="java.lang.String"/>
		<field name="COL_SORT" class="java.lang.String"/>
		<field name="COL_NAME" class="java.lang.String"/>
		<field name="CNT" class="java.lang.Integer"/>
		<variable name="NUM_ROWS" class="java.lang.Integer" incrementType="Report">
			<variableExpression><![CDATA[$V{REPORT_COUNT}]]></variableExpression>
		</variable>
	</subDataset>
	<parameter name="ROOT_REPORT_PATH" class="java.lang.String"/>
	<parameter name="DATE_FROM" class="java.lang.String"/>
	<parameter name="DATE_TO" class="java.lang.String"/>
	<parameter name="REPORT_NAME" class="java.lang.String"/>
	<parameter name="REPORT_CODE" class="java.lang.String"/>
	<parameter name="REPORT_PARAMETERS_LIST" class="java.lang.String"/>
	<parameter name="CUSTOMER_IDS" class="java.lang.String"/>
	<parameter name="DEPARTMENT_IDS" class="java.lang.String"/>
	<parameter name="TRANSPOSE" class="java.lang.String"/>
	<parameter name="NO_DEPARTMENT" class="java.lang.String"/>
	<parameter name="NO_CUSTDEP" class="java.lang.String"/>
	<parameter name="NO_REJECT" class="java.lang.String"/>
	<queryString language="plsql">
		<![CDATA[WITH t AS (
    SELECT id
         , text
      FROM lab.lu
     WHERE tag = 15
     UNION ALL
    SELECT NULL
         , 'Прочие'
  )
SELECT *
  FROM t
 WHERE ($P{DEPARTMENT_IDS} IS NULL OR id = ANY (string_to_array($P{DEPARTMENT_IDS}, ',')::BIGINT[]))
/*Добавляем для режима без разделения отчелов //20221012,ak*/
AND nullif($P{NO_DEPARTMENT},'0') is null
UNION ALL
SELECT -1::BIGINT
,'Без разделения'
WHERE $P{NO_DEPARTMENT} = '1']]>
	</queryString>
	<field name="ID" class="java.lang.String"/>
	<field name="TEXT" class="java.lang.String"/>
	<variable name="NUM_ROWS" class="java.lang.Integer" incrementType="Report"/>
	<variable name="VAR" class="java.lang.String" resetType="None">
		<variableExpression><![CDATA[$P{REPORT_PARAMETERS_MAP}.put( "HEADER_NAME", $F{TEXT} )]]></variableExpression>
	</variable>
	<pageHeader>
		<band height="40" splitType="Prevent">
			<textField isStretchWithOverflow="true" isBlankWhenNull="false">
				<reportElement x="0" y="0" width="802" height="20" uuid="33ca7fe8-894f-47cf-9d0e-86c8baec46a7">
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
				</reportElement>
				<box padding="1">
					<topPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.0"/>
				</box>
				<textElement textAlignment="Center">
					<font fontName="DejaVu Sans" size="11" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{REPORT_NAME}]]></textFieldExpression>
			</textField>
			<componentElement>
				<reportElement positionType="Float" x="0" y="20" width="802" height="15" uuid="664ad158-0fd4-473b-b11d-f9a52cb46e78">
					<property name="com.jaspersoft.studio.unit.x" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
				</reportElement>
				<jr:list xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" printOrder="Vertical">
					<datasetRun subDataset="PARAMETERS_LIST" uuid="53c420da-8c36-4425-81a2-ce9dd2cc704c">
						<datasetParameter name="ORACLE_REF_CURSOR">
							<datasetParameterExpression><![CDATA[$P{ORACLE_REF_CURSOR}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="REPORT_PARAMETERS_LIST">
							<datasetParameterExpression><![CDATA[$P{REPORT_PARAMETERS_LIST}]]></datasetParameterExpression>
						</datasetParameter>
						<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
					</datasetRun>
					<jr:listContents height="15" width="802">
						<textField isStretchWithOverflow="true" isBlankWhenNull="true">
							<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="0" y="0" width="802" height="15" uuid="6f1e6cce-56fa-48d1-aee1-f6d8b9288b56">
								<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
								<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
							</reportElement>
							<box padding="1"/>
							<textElement verticalAlignment="Middle">
								<font fontName="DejaVu Sans" size="9"/>
							</textElement>
							<textFieldExpression><![CDATA[$F{PARAMETER}]]></textFieldExpression>
						</textField>
					</jr:listContents>
				</jr:list>
			</componentElement>
		</band>
	</pageHeader>
	<detail>
		<band>
			<crosstab ignoreWidth="true">
				<reportElement positionType="Float" x="0" y="0" width="802" height="0" uuid="9eb29650-4789-43be-8ce1-4664978ce530">
					<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.VerticalRowLayout"/>
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
					<property name="net.sf.jasperreports.export.headertoolbar.table.name" value=""/>
					<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
				</reportElement>
				<crosstabParameter name="HEADER_NAME"/>
				<parametersMapExpression><![CDATA[$P{REPORT_PARAMETERS_MAP}]]></parametersMapExpression>
				<crosstabDataset>
					<dataset>
						<datasetRun subDataset="SRV_TBL_LDEP_PLACE" uuid="806c3f33-4c00-41e7-ba46-4c5fe69c4a3b">
							<parametersMapExpression><![CDATA[$P{REPORT_PARAMETERS_MAP}]]></parametersMapExpression>
							<datasetParameter name="DEP_ID">
								<datasetParameterExpression><![CDATA[$F{ID}]]></datasetParameterExpression>
							</datasetParameter>
							<datasetParameter name="ORACLE_REF_CURSOR">
								<datasetParameterExpression><![CDATA[$P{ORACLE_REF_CURSOR}]]></datasetParameterExpression>
							</datasetParameter>
							<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
							<returnValue fromVariable="NUM_ROWS" toVariable="NUM_ROWS"/>
						</datasetRun>
					</dataset>
				</crosstabDataset>
				<crosstabHeaderCell>
					<cellContents>
						<textField isStretchWithOverflow="true" isBlankWhenNull="false">
							<reportElement stretchType="RelativeToBandHeight" x="0" y="0" width="100" height="14" uuid="041f7979-60af-459f-aa8b-626a30a9dc6c">
								<property name="net.sf.jasperreports.export.xls.auto.fit.row" value="true"/>
								<property name="net.sf.jasperreports.export.xls.freeze.row.edge" value="Bottom"/>
								<propertyExpression name="net.sf.jasperreports.export.xls.sheet.name"><![CDATA[$P{HEADER_NAME}.replaceAll("[\\\\/\\*\\?:\\[\\]]", "")]]></propertyExpression>
							</reportElement>
							<box padding="1">
								<topPen lineWidth="0.6"/>
								<leftPen lineWidth="0.6"/>
								<bottomPen lineWidth="0.6"/>
								<rightPen lineWidth="0.6"/>
							</box>
							<textElement verticalAlignment="Middle">
								<font fontName="DejaVu Sans" size="8" isBold="true" isUnderline="true" isStrikeThrough="false"/>
								<paragraph leftIndent="2" rightIndent="2"/>
							</textElement>
							<textFieldExpression><![CDATA[$P{HEADER_NAME}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabHeaderCell>
				<rowGroup name="ROW1" width="100" totalPosition="End">
					<bucket class="java.lang.String">
						<bucketExpression><![CDATA[$F{ROW_NAME}]]></bucketExpression>
					</bucket>
					<crosstabRowHeader>
						<cellContents mode="Opaque" style="Crosstab_CH">
							<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
							<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
							<property name="net.sf.jasperreports.export.xls.auto.fit.row" value="true"/>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement stretchType="RelativeToBandHeight" x="0" y="0" width="100" height="14" uuid="b83fc039-d1a3-4102-9306-ee534d66f096">
									<property name="net.sf.jasperreports.export.xls.auto.fit.row" value="true"/>
									<property name="net.sf.jasperreports.export.xls.freeze.column.edge" value="Right"/>
								</reportElement>
								<box padding="1"/>
								<textElement verticalAlignment="Middle">
									<font fontName="DejaVu Sans" size="8"/>
									<paragraph leftIndent="2" rightIndent="2"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{ROW1}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabRowHeader>
					<crosstabTotalRowHeader>
						<cellContents mode="Opaque" style="Crosstab_CT">
							<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
							<staticText>
								<reportElement x="0" y="0" width="100" height="14" forecolor="#030202" uuid="82dbf48f-efb6-4881-a8de-22dba598821e">
									<property name="net.sf.jasperreports.export.xls.auto.fit.row" value="true"/>
								</reportElement>
								<box padding="1"/>
								<textElement verticalAlignment="Middle">
									<font fontName="DejaVu Sans" size="8"/>
								</textElement>
								<text><![CDATA[Итого]]></text>
							</staticText>
						</cellContents>
					</crosstabTotalRowHeader>
				</rowGroup>
				<columnGroup name="COL1" height="14" totalPosition="End">
					<bucket class="java.lang.String">
						<bucketExpression><![CDATA[$F{COL_NAME}]]></bucketExpression>
					</bucket>
					<crosstabColumnHeader>
						<cellContents mode="Opaque" style="Crosstab_CH">
							<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement stretchType="RelativeToBandHeight" x="0" y="0" width="43" height="14" uuid="e213e46d-6a8d-4688-961a-12d723ebf74e">
									<property name="net.sf.jasperreports.export.xls.auto.fit.row" value="true"/>
									<property name="net.sf.jasperreports.export.xls.freeze.row.edge" value="Bottom"/>
								</reportElement>
								<box padding="1"/>
								<textElement verticalAlignment="Middle">
									<font fontName="DejaVu Sans" size="8"/>
									<paragraph leftIndent="2" rightIndent="2"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{COL1}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabColumnHeader>
					<crosstabTotalColumnHeader>
						<cellContents mode="Opaque" style="Crosstab_CT">
							<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
							<staticText>
								<reportElement stretchType="RelativeToBandHeight" x="0" y="0" width="43" height="14" forecolor="#000000" uuid="22af0b54-9e5a-419d-9771-6c91ae785cb9">
									<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
									<property name="net.sf.jasperreports.export.xls.auto.fit.row" value="true"/>
								</reportElement>
								<box padding="1"/>
								<textElement textAlignment="Left" verticalAlignment="Middle">
									<font fontName="DejaVu Sans" size="8"/>
								</textElement>
								<text><![CDATA[Итого]]></text>
							</staticText>
						</cellContents>
					</crosstabTotalColumnHeader>
				</columnGroup>
				<measure name="CNT_MEASURE1" class="java.lang.Integer" calculation="Sum">
					<measureExpression><![CDATA[$F{CNT}]]></measureExpression>
				</measure>
				<crosstabCell width="43" height="14">
					<cellContents mode="Opaque" style="Crosstab_CD">
						<textField isStretchWithOverflow="true" isBlankWhenNull="true">
							<reportElement stretchType="RelativeToBandHeight" x="0" y="0" width="43" height="14" uuid="e4f2d047-558b-4cb3-af11-cba356cfeb9d">
								<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
								<property name="net.sf.jasperreports.export.xls.auto.fit.row" value="true"/>
							</reportElement>
							<box padding="1"/>
							<textElement textAlignment="Right" verticalAlignment="Middle">
								<font fontName="DejaVu Sans" size="8"/>
								<paragraph leftIndent="2" rightIndent="2"/>
							</textElement>
							<textFieldExpression><![CDATA[$V{CNT_MEASURE1}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
				<crosstabCell width="43" height="14" columnTotalGroup="COL1">
					<cellContents mode="Opaque" style="Crosstab_CT">
						<textField isStretchWithOverflow="true" isBlankWhenNull="true">
							<reportElement stretchType="RelativeToBandHeight" x="0" y="0" width="43" height="14" forecolor="#030303" uuid="f94d0eda-a56f-4c07-8a56-150105e4e6ea">
								<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
								<property name="net.sf.jasperreports.export.xls.auto.fit.row" value="true"/>
							</reportElement>
							<box padding="1"/>
							<textElement textAlignment="Right" verticalAlignment="Middle">
								<font fontName="DejaVu Sans" size="8"/>
								<paragraph leftIndent="2" rightIndent="2"/>
							</textElement>
							<textFieldExpression><![CDATA[$V{CNT_MEASURE1}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
				<crosstabCell width="43" height="14" rowTotalGroup="ROW1">
					<cellContents mode="Opaque" style="Crosstab_CT">
						<textField isStretchWithOverflow="true" isBlankWhenNull="true">
							<reportElement x="0" y="0" width="43" height="14" forecolor="#030303" uuid="9cda8035-62a9-4eef-baef-8efa2eb8b010">
								<property name="net.sf.jasperreports.export.xls.auto.fit.row" value="true"/>
							</reportElement>
							<box padding="1"/>
							<textElement textAlignment="Right" verticalAlignment="Middle">
								<font fontName="DejaVu Sans" size="8"/>
								<paragraph leftIndent="2" rightIndent="2"/>
							</textElement>
							<textFieldExpression><![CDATA[$V{CNT_MEASURE1}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
				<crosstabCell width="43" height="14" rowTotalGroup="ROW1" columnTotalGroup="COL1">
					<cellContents mode="Opaque" style="Crosstab_CT">
						<textField isStretchWithOverflow="true" isBlankWhenNull="true">
							<reportElement x="0" y="0" width="43" height="14" forecolor="#000000" uuid="c4c28712-4f23-480d-9ed8-e22d543c42e7">
								<property name="net.sf.jasperreports.export.xls.auto.fit.row" value="true"/>
							</reportElement>
							<box padding="1"/>
							<textElement textAlignment="Right" verticalAlignment="Middle">
								<font fontName="DejaVu Sans" size="8"/>
								<paragraph leftIndent="2" rightIndent="2"/>
							</textElement>
							<textFieldExpression><![CDATA[$V{CNT_MEASURE1}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
			</crosstab>
		</band>
		<band height="1">
			<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
			<printWhenExpression><![CDATA[$V{NUM_ROWS} > 0]]></printWhenExpression>
			<break>
				<reportElement x="0" y="0" width="802" height="1" uuid="8f076e99-239b-4865-8718-1f71418d3ea8">
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
				</reportElement>
			</break>
		</band>
	</detail>
</jasperReport>
