<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.2.0.final using JasperReports Library version 6.2.0  -->
<!-- 2022-11-09T10:49:27 -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="stat_7_2_pervDGB" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="802" leftMargin="20" rightMargin="20" topMargin="10" bottomMargin="10" isIgnorePagination="true" uuid="4e4352f6-4aa8-47ca-9900-bfec8f7fe673">
	<property name="net.sf.jasperreports.print.create.bookmarks" value="false"/>
	<property name="com.jaspersoft.studio.unit." value="pixel"/>
	<property name="net.sf.jasperreports.export.xls.one.page.per.sheet" value="true"/>
	<property name="net.sf.jasperreports.export.xls.white.page.background" value="false"/>
	<property name="net.sf.jasperreports.export.xls.remove.empty.space.between.rows" value="false"/>
	<property name="net.sf.jasperreports.export.xls.remove.empty.space.between.columns" value="false"/>
	<property name="net.sf.jasperreports.export.xls.detect.cell.type" value="true"/>
	<property name="net.sf.jasperreports.exports.xls.font.size.fix.enabled" value="false"/>
	<property name="net.sf.jasperreports.export.xls.force.page.breaks" value="true"/>
	<property name="net.sf.jasperreports.page.break.no.pagination" value="apply"/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="One Empty Record"/>
	<style name="Table_TH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table_CH" mode="Opaque" backcolor="#BFE1FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table_TD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab_CH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab_CG" mode="Opaque" backcolor="#BFE1FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab_CT" mode="Opaque" backcolor="#005FB3">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab_CD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab 1_CH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab 1_CG" mode="Opaque" backcolor="#BFE1FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab 1_CT" mode="Opaque" backcolor="#005FB3">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab 1_CD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab 2_CH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab 2_CG" mode="Opaque" backcolor="#BFE1FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab 2_CT" mode="Opaque" backcolor="#005FB3">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab 2_CD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab 3_CH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab 3_CT" mode="Opaque" backcolor="#005FB3">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab 3_CG" mode="Opaque" backcolor="#BFE1FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab 3_CD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab 4_CH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab 4_CG" mode="Opaque" backcolor="#BFE1FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab 4_CT" mode="Opaque" backcolor="#005FB3">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab 4_CD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<subDataset name="PARAMETERS_LIST" uuid="0432a849-4e5f-49b6-bd26-b107c6f6f1e2">
		<property name="com.jaspersoft.studio.data.defaultdataadapter" value="One Empty Record"/>
		<parameter name="REPORT_PARAMETERS_LIST" class="java.lang.String"/>
		<queryString language="plsql">
			<![CDATA[SELECT unnest AS parameter
  FROM unnest(string_to_array($P{REPORT_PARAMETERS_LIST}, ';'))]]>
		</queryString>
		<field name="PARAMETER" class="java.lang.String"/>
	</subDataset>
	<subDataset name="SRV_TBL_LDEP_PLACE" uuid="390adceb-40b6-4a13-b9c6-e09948cecae4">
		<property name="com.jaspersoft.studio.data.defaultdataadapter" value="One Empty Record"/>
		<parameter name="DATE_FROM" class="java.lang.String"/>
		<parameter name="DATE_TO" class="java.lang.String"/>
		<parameter name="DEP_ID" class="java.lang.String"/>
		<parameter name="CUSTOMER_IDS" class="java.lang.String"/>
		<queryString language="plsql">
			<![CDATA[WITH 
custom as (SELECT  distinct a2.text, a3.linkid
  		    FROM med.attr a1
    			,med.attr a2
    			,med.attr a3
		    WHERE a1.keyid = a2.rootid
   		    AND a2.keyid = a3.rootid
  		    AND a1.code = 9920
  		    AND a1.tag = 59)
,res_gr as (SELECT  distinct a2.text, a3.linkid
  		    FROM med.attr a1
    			,med.attr a2
    			,med.attr a3
		    WHERE a1.keyid = a2.rootid
   		    AND a2.keyid = a3.rootid
  		    AND a1.code = 9920
  		    AND a1.tag = 38)
,t AS (
    SELECT cast(1 as text)                                         AS srv_sort
         ,(select (regexp_matches(regexp_replace(coalesce(w.shorttext,w.text), '[%=]','', 'g'), '^[^\[]*', 'g'))[1] offset 0 limit 1) AS srv_name
         , coalesce(cust.sortcode, 0)::VARCHAR                    AS cust_sort
         , CASE
             WHEN length(cust.shorttext) > 0 THEN cust.shorttext
             WHEN length(cust.text) > 0 THEN cust.text
             ELSE 'Прочие'
           END                                                    AS cust_name
         , owf.id                                  AS cnt
         ,(cast(w.uet_v AS DOUBLE PRECISION) + cast(w.uet_e AS DOUBLE PRECISION)) as uet
         ,coalesce(custom.text, 'ВСЕ') as custom_gr
         ,coalesce(res_gr.text, 'ВСЕ') as res_gr
      FROM lab.research r
      JOIN lab.order_info oi ON oi.research_id = r.id
      JOIN med.srvdep srv ON srv.keyid = oi.srvdep_id
      JOIN lab.orderworkflow owf ON owf.order_id = oi.id
      JOIN lab.workflow wf ON wf.id = owf.workflow_id
      JOIN lab.work w ON w.id = wf.work_id
      JOIN lab.workplace wp ON wp.id = w.workplace_id
      LEFT JOIN lab.lu cust ON cust.id = r.external_customer_id
      LEFT JOIN custom on custom.linkid = r.external_customer_id
      LEFT JOIN res_gr on res_gr.linkid = w.id
       WHERE r.status IN ('A','R','F')
       AND oi.result_status IN (1,2)
  	   AND oi.check_status IN (1,2)
 	   AND owf.result_status IN (1,2)
  	   AND owf.check_status IN (1,2)
       AND w.typ_id NOT IN (SELECT id
                              FROM lab.lu
                             WHERE tag = 16
                               AND code IN (1,3,4))
       AND (wp.place_id = $P{DEP_ID}::BIGINT OR (wp.place_id IS NULL AND $P{DEP_ID} IS NULL))
       AND date_trunc('day', r.collectdate) BETWEEN to_date($P{DATE_FROM}, 'yyyy-mm-dd hh24:mi:ss') AND coalesce(
         to_date($P{DATE_TO}, 'yyyy-mm-dd hh24:mi:ss'), current_date)
       AND ($P{CUSTOMER_IDS} IS NULL OR
            r.external_customer_id = ANY (string_to_array($P{CUSTOMER_IDS}, ', ')::BIGINT[]))

  )
  
SELECT srv_sort  AS col_sort
     , srv_name AS col_name
     , cust_sort  AS row_sort
     , cust_name  AS row_name
     ,custom_gr
     ,res_gr
     , count(distinct cnt) as cnt
     , (case when Sum(uet) = 0 then null else Sum(uet) end ) as uet_sum
  FROM t
 GROUP BY srv_sort, srv_name, cust_sort, cust_name, custom_gr,res_gr
 ORDER BY custom_gr, res_gr, row_sort, row_name, col_sort, col_name]]>
		</queryString>
		<field name="ROW_SORT" class="java.lang.String"/>
		<field name="ROW_NAME" class="java.lang.String"/>
		<field name="COL_SORT" class="java.lang.String"/>
		<field name="COL_NAME" class="java.lang.String"/>
		<field name="CNT" class="java.lang.Integer"/>
		<field name="UET_SUM" class="java.lang.Float"/>
		<field name="CUSTOM_GR" class="java.lang.String"/>
		<field name="RES_GR" class="java.lang.String"/>
		<variable name="NUM_ROWS" class="java.lang.Integer" incrementType="Report">
			<variableExpression><![CDATA[$V{REPORT_COUNT}]]></variableExpression>
		</variable>
	</subDataset>
	<parameter name="ROOT_REPORT_PATH" class="java.lang.String"/>
	<parameter name="DATE_FROM" class="java.lang.String"/>
	<parameter name="DATE_TO" class="java.lang.String"/>
	<parameter name="REPORT_NAME" class="java.lang.String"/>
	<parameter name="REPORT_CODE" class="java.lang.String"/>
	<parameter name="REPORT_PARAMETERS_LIST" class="java.lang.String"/>
	<parameter name="CUSTOMER_IDS" class="java.lang.String"/>
	<parameter name="DEPARTMENT_IDS" class="java.lang.String"/>
	<parameter name="TRANSPOSE" class="java.lang.String"/>
	<queryString language="plsql">
		<![CDATA[WITH t AS (
    SELECT id
         , text
      FROM lab.lu
     WHERE tag = 15
     UNION ALL
    SELECT NULL
         , 'Прочие'
  )
SELECT *
  FROM t
 WHERE ($P{DEPARTMENT_IDS} IS NULL OR id = ANY (string_to_array($P{DEPARTMENT_IDS}, ',')::BIGINT[]))]]>
	</queryString>
	<field name="ID" class="java.lang.String"/>
	<field name="TEXT" class="java.lang.String"/>
	<variable name="NUM_ROWS" class="java.lang.Integer" incrementType="Report"/>
	<variable name="VAR" class="java.lang.String" resetType="None">
		<variableExpression><![CDATA[$P{REPORT_PARAMETERS_MAP}.put( "HEADER_NAME", $F{TEXT} )]]></variableExpression>
	</variable>
	<group name="Group1"/>
	<pageHeader>
		<band height="40" splitType="Prevent">
			<textField isStretchWithOverflow="true" isBlankWhenNull="false">
				<reportElement x="0" y="0" width="802" height="20" uuid="33ca7fe8-894f-47cf-9d0e-86c8baec46a7">
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
				</reportElement>
				<box padding="1">
					<topPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.0"/>
				</box>
				<textElement textAlignment="Center">
					<font fontName="DejaVu Sans" size="11" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{REPORT_NAME}]]></textFieldExpression>
			</textField>
			<componentElement>
				<reportElement positionType="Float" x="0" y="20" width="802" height="15" uuid="664ad158-0fd4-473b-b11d-f9a52cb46e78">
					<property name="com.jaspersoft.studio.unit.x" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
				</reportElement>
				<jr:list xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" printOrder="Vertical">
					<datasetRun subDataset="PARAMETERS_LIST" uuid="53c420da-8c36-4425-81a2-ce9dd2cc704c">
						<datasetParameter name="ORACLE_REF_CURSOR">
							<datasetParameterExpression><![CDATA[$P{ORACLE_REF_CURSOR}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="REPORT_PARAMETERS_LIST">
							<datasetParameterExpression><![CDATA[$P{REPORT_PARAMETERS_LIST}]]></datasetParameterExpression>
						</datasetParameter>
						<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
					</datasetRun>
					<jr:listContents height="15" width="802">
						<textField isStretchWithOverflow="true" isBlankWhenNull="true">
							<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="0" y="0" width="802" height="15" uuid="6f1e6cce-56fa-48d1-aee1-f6d8b9288b56">
								<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
								<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
							</reportElement>
							<box padding="1"/>
							<textElement verticalAlignment="Middle">
								<font fontName="DejaVu Sans" size="9"/>
							</textElement>
							<textFieldExpression><![CDATA[$F{PARAMETER}]]></textFieldExpression>
						</textField>
					</jr:listContents>
				</jr:list>
			</componentElement>
		</band>
	</pageHeader>
	<detail>
		<band>
			<crosstab ignoreWidth="true">
				<reportElement positionType="Float" x="0" y="0" width="802" height="0" uuid="1c6faf01-da9b-4a85-861d-87ee4506ebf1">
					<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.VerticalRowLayout"/>
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
					<property name="net.sf.jasperreports.export.headertoolbar.table.name" value=""/>
				</reportElement>
				<crosstabParameter name="HEADER_NAME"/>
				<parametersMapExpression><![CDATA[$P{REPORT_PARAMETERS_MAP}]]></parametersMapExpression>
				<crosstabDataset>
					<dataset>
						<datasetRun subDataset="SRV_TBL_LDEP_PLACE" uuid="32a81cc4-1cc3-4e57-adfd-31304a761829">
							<parametersMapExpression><![CDATA[$P{REPORT_PARAMETERS_MAP}]]></parametersMapExpression>
							<datasetParameter name="DEP_ID">
								<datasetParameterExpression><![CDATA[$F{ID}]]></datasetParameterExpression>
							</datasetParameter>
							<datasetParameter name="ORACLE_REF_CURSOR">
								<datasetParameterExpression><![CDATA[$P{ORACLE_REF_CURSOR}]]></datasetParameterExpression>
							</datasetParameter>
							<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
							<returnValue fromVariable="NUM_ROWS" toVariable="NUM_ROWS"/>
						</datasetRun>
					</dataset>
				</crosstabDataset>
				<crosstabHeaderCell>
					<cellContents>
						<textField isStretchWithOverflow="true" isBlankWhenNull="false">
							<reportElement stretchType="RelativeToBandHeight" x="0" y="0" width="160" height="40" uuid="ae30559c-aac8-49da-bc71-a5e5ffbca591">
								<property name="net.sf.jasperreports.export.xls.auto.fit.row" value="true"/>
								<property name="net.sf.jasperreports.export.xls.freeze.row.edge" value="Bottom"/>
								<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
								<propertyExpression name="net.sf.jasperreports.export.xls.sheet.name"><![CDATA[$P{HEADER_NAME}.replaceAll("[\\\\/\\*\\?:\\[\\]]", "")]]></propertyExpression>
							</reportElement>
							<box padding="1">
								<topPen lineWidth="0.6"/>
								<leftPen lineWidth="0.6"/>
								<bottomPen lineWidth="0.6"/>
								<rightPen lineWidth="0.6"/>
							</box>
							<textElement verticalAlignment="Middle">
								<font fontName="DejaVu Sans" size="8" isBold="true" isUnderline="true" isStrikeThrough="false"/>
								<paragraph leftIndent="2" rightIndent="2" tabStopWidth="500"/>
							</textElement>
							<textFieldExpression><![CDATA[$P{HEADER_NAME}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabHeaderCell>
				<rowGroup name="CUSTOM_GR1" width="60" totalPosition="End">
					<bucket class="java.lang.String">
						<bucketExpression><![CDATA[$F{CUSTOM_GR}]]></bucketExpression>
					</bucket>
					<crosstabRowHeader>
						<cellContents mode="Opaque" style="Crosstab 4_CH">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement stretchType="RelativeToBandHeight" x="0" y="0" width="60" height="78" isRemoveLineWhenBlank="true" uuid="88c6eb8b-d014-4850-8403-9133746b7346">
									<property name="net.sf.jasperreports.export.xls.auto.fit.row" value="true"/>
									<property name="net.sf.jasperreports.export.xls.freeze.column.edge" value="Right"/>
								</reportElement>
								<textElement textAlignment="Left" verticalAlignment="Middle">
									<font fontName="DejaVu Sans" isBold="true"/>
									<paragraph tabStopWidth="500"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{CUSTOM_GR1}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabRowHeader>
					<crosstabTotalRowHeader>
						<cellContents mode="Opaque" style="Crosstab 4_CT">
							<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
							<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
							<property name="net.sf.jasperreports.export.xls.auto.fit.row" value="true"/>
							<textField>
								<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="0" y="0" width="130" height="28" forecolor="#FFFFFF" uuid="2a472aa5-0f91-4122-8c52-54e8ae2a6a40">
									<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
									<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
									<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
								</reportElement>
								<textElement verticalAlignment="Middle">
									<font fontName="DejaVu Sans" isBold="true"/>
									<paragraph tabStopWidth="500"/>
								</textElement>
								<textFieldExpression><![CDATA["ИТОГО"]]></textFieldExpression>
							</textField>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement stretchType="RelativeToBandHeight" x="130" y="0" width="30" height="14" uuid="c1378f81-40bf-4f1b-859c-d2e374fef77f">
									<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
									<property name="com.jaspersoft.studio.unit.x" value="pixel"/>
									<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
									<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
								</reportElement>
								<box>
									<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
									<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
									<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
									<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
								</box>
								<textElement>
									<font fontName="DejaVu Sans" size="7" isBold="false"/>
									<paragraph tabStopWidth="500"/>
								</textElement>
								<textFieldExpression><![CDATA["кол-во"]]></textFieldExpression>
							</textField>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement positionType="Float" x="130" y="14" width="30" height="14" uuid="a92c3078-4e6d-4875-ab40-97930e546aa8">
									<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
								</reportElement>
								<box>
									<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
									<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
									<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
									<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
								</box>
								<textElement>
									<font fontName="DejaVu Sans" size="7" isBold="false"/>
									<paragraph tabStopWidth="500"/>
								</textElement>
								<textFieldExpression><![CDATA["УЕТ"]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabTotalRowHeader>
				</rowGroup>
				<rowGroup name="ROW_NAME1" width="100" totalPosition="End">
					<bucket class="java.lang.String">
						<bucketExpression><![CDATA[$F{ROW_NAME}]]></bucketExpression>
					</bucket>
					<crosstabRowHeader>
						<cellContents mode="Opaque" style="Crosstab 4_CH">
							<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
							<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.FreeLayout"/>
							<box topPadding="0" bottomPadding="0"/>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement stretchType="RelativeToBandHeight" x="0" y="0" width="100" height="50" uuid="72ecc11d-a4ce-48dd-b311-1ecb22618223">
									<property name="net.sf.jasperreports.export.xls.freeze.column.edge" value="Right"/>
									<property name="net.sf.jasperreports.export.xls.wrap.text" value="false"/>
									<property name="net.sf.jasperreports.print.keep.full.text" value="true"/>
									<property name="net.sf.jasperreports.export.xls.auto.fit.row" value="true"/>
									<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
									<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
								</reportElement>
								<box topPadding="0" bottomPadding="0" rightPadding="0"/>
								<textElement verticalAlignment="Middle" markup="none">
									<font fontName="DejaVu Sans" size="10"/>
									<paragraph lineSpacing="Single" spacingBefore="2" spacingAfter="2" tabStopWidth="500"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{ROW_NAME1}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabRowHeader>
					<crosstabTotalRowHeader>
						<cellContents mode="Opaque" style="Crosstab 4_CG">
							<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
							<property name="net.sf.jasperreports.export.xls.auto.fit.row" value="true"/>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="0" y="0" width="100" height="28" isRemoveLineWhenBlank="true" uuid="ba63fdcd-3018-42d1-8fd2-57ed476d5e9a">
									<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
								</reportElement>
								<textElement textAlignment="Left" verticalAlignment="Middle">
									<font fontName="DejaVu Sans" isBold="true"/>
									<paragraph tabStopWidth="500"/>
								</textElement>
								<textFieldExpression><![CDATA["ВСЕГО"]]></textFieldExpression>
							</textField>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement stretchType="RelativeToBandHeight" x="70" y="0" width="30" height="14" isRemoveLineWhenBlank="true" uuid="97af3a72-cb52-470e-b201-ba095035e2ac">
									<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
									<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
									<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
									<property name="com.jaspersoft.studio.unit.x" value="pixel"/>
								</reportElement>
								<box>
									<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
									<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
									<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
									<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
								</box>
								<textElement>
									<font fontName="DejaVu Sans" size="7" isBold="false"/>
									<paragraph tabStopWidth="500"/>
								</textElement>
								<textFieldExpression><![CDATA["кол-во"]]></textFieldExpression>
							</textField>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement positionType="Float" x="70" y="14" width="30" height="14" isRemoveLineWhenBlank="true" uuid="8aec9c00-c360-443b-8e67-968a05307785">
									<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
									<property name="com.jaspersoft.studio.unit.x" value="pixel"/>
								</reportElement>
								<box>
									<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
									<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
									<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
									<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
								</box>
								<textElement>
									<font fontName="DejaVu Sans" size="7" isBold="false"/>
									<paragraph tabStopWidth="500"/>
								</textElement>
								<textFieldExpression><![CDATA["УЕТ"]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabTotalRowHeader>
				</rowGroup>
				<columnGroup name="RES_GR1" height="20" totalPosition="End">
					<bucket class="java.lang.String">
						<bucketExpression><![CDATA[$F{RES_GR}]]></bucketExpression>
					</bucket>
					<crosstabColumnHeader>
						<cellContents mode="Opaque" style="Crosstab 4_CH">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement stretchType="RelativeToBandHeight" x="0" y="0" width="120" height="20" isRemoveLineWhenBlank="true" uuid="6fd75eb9-0327-4d83-b2a9-388004ca28b7"/>
								<textElement textAlignment="Center" verticalAlignment="Top">
									<font fontName="DejaVu Sans" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{RES_GR1}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabColumnHeader>
					<crosstabTotalColumnHeader>
						<cellContents mode="Opaque" style="Crosstab 4_CT">
							<staticText>
								<reportElement positionType="Float" x="0" y="0" width="60" height="40" forecolor="#FFFFFF" uuid="511284e4-8b32-4b0e-8320-aa1affc06305"/>
								<textElement>
									<font fontName="DejaVu Sans" isBold="true"/>
								</textElement>
								<text><![CDATA[ИТОГО]]></text>
							</staticText>
						</cellContents>
					</crosstabTotalColumnHeader>
				</columnGroup>
				<columnGroup name="COL_NAME1" height="20" totalPosition="End">
					<bucket class="java.lang.String">
						<bucketExpression><![CDATA[$F{COL_NAME}]]></bucketExpression>
					</bucket>
					<crosstabColumnHeader>
						<cellContents mode="Opaque" style="Crosstab 4_CH">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement stretchType="RelativeToBandHeight" x="0" y="0" width="60" height="20" isRemoveLineWhenBlank="true" uuid="b31e99b6-215c-4853-ac9f-805b51d89ad5"/>
								<textElement>
									<font fontName="DejaVu Sans"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{COL_NAME1}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabColumnHeader>
					<crosstabTotalColumnHeader>
						<cellContents mode="Opaque" style="Crosstab 4_CG">
							<staticText>
								<reportElement positionType="Float" x="0" y="0" width="60" height="20" isRemoveLineWhenBlank="true" uuid="b786c955-ce1e-4b7f-b525-b5f2a06a8c45"/>
								<textElement>
									<font fontName="DejaVu Sans" isBold="true"/>
								</textElement>
								<text><![CDATA[ВСЕГО]]></text>
							</staticText>
						</cellContents>
					</crosstabTotalColumnHeader>
				</columnGroup>
				<measure name="CNT_MEASURE1" class="java.lang.Integer" calculation="Sum">
					<measureExpression><![CDATA[$F{CNT}]]></measureExpression>
				</measure>
				<measure name="UET_SUM_MEASURE1" class="java.lang.Float" calculation="Sum">
					<measureExpression><![CDATA[$F{UET_SUM}]]></measureExpression>
				</measure>
				<crosstabCell width="60" height="50">
					<cellContents mode="Opaque" style="Crosstab 4_CD">
						<textField isBlankWhenNull="true">
							<reportElement stretchType="RelativeToBandHeight" x="0" y="0" width="60" height="25" isRemoveLineWhenBlank="true" uuid="8dcf882c-927d-469b-a353-05232271a754">
								<property name="net.sf.jasperreports.export.xls.auto.fit.row" value="true"/>
							</reportElement>
							<textFieldExpression><![CDATA[$V{CNT_MEASURE1}]]></textFieldExpression>
						</textField>
						<textField isBlankWhenNull="true">
							<reportElement positionType="Float" x="0" y="25" width="60" height="25" isRemoveLineWhenBlank="true" uuid="77032b13-fec8-4ed3-bba2-90ff482191b7">
								<property name="net.sf.jasperreports.export.xls.auto.fit.row" value="true"/>
							</reportElement>
							<textFieldExpression><![CDATA[$V{UET_SUM_MEASURE1}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
				<crosstabCell width="60" height="50" columnTotalGroup="RES_GR1">
					<cellContents mode="Opaque" style="Crosstab 4_CT">
						<textField isBlankWhenNull="true">
							<reportElement stretchType="RelativeToBandHeight" x="0" y="0" width="60" height="25" forecolor="#FFFFFF" uuid="5ce8b451-85eb-4a44-8cf9-a7a993a9a40a">
								<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
								<property name="net.sf.jasperreports.export.xls.auto.fit.row" value="true"/>
							</reportElement>
							<textFieldExpression><![CDATA[$V{CNT_MEASURE1}]]></textFieldExpression>
						</textField>
						<textField isBlankWhenNull="true">
							<reportElement positionType="Float" x="0" y="25" width="60" height="25" forecolor="#FFFFFF" uuid="6475f1c3-48cd-42ab-911d-ff66a175d02a">
								<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
								<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
								<property name="net.sf.jasperreports.export.xls.auto.fit.row" value="true"/>
							</reportElement>
							<textFieldExpression><![CDATA[$V{UET_SUM_MEASURE1}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
				<crosstabCell width="60" height="50" columnTotalGroup="COL_NAME1">
					<cellContents mode="Opaque" style="Crosstab 4_CG">
						<textField isBlankWhenNull="true">
							<reportElement stretchType="RelativeToBandHeight" x="0" y="0" width="60" height="25" isRemoveLineWhenBlank="true" uuid="785e973c-33cb-45fa-a4d8-e9894066687c">
								<property name="net.sf.jasperreports.export.xls.auto.fit.row" value="true"/>
							</reportElement>
							<textFieldExpression><![CDATA[$V{CNT_MEASURE1}]]></textFieldExpression>
						</textField>
						<textField isBlankWhenNull="true">
							<reportElement positionType="Float" x="0" y="25" width="60" height="25" isRemoveLineWhenBlank="true" uuid="ccfc34b3-47c3-47db-a57a-816a9db8987c">
								<property name="net.sf.jasperreports.export.xls.auto.fit.row" value="true"/>
							</reportElement>
							<textFieldExpression><![CDATA[$V{UET_SUM_MEASURE1}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
				<crosstabCell width="60" height="28" rowTotalGroup="CUSTOM_GR1">
					<cellContents mode="Opaque" style="Crosstab 4_CT">
						<textField isBlankWhenNull="true">
							<reportElement stretchType="RelativeToBandHeight" x="0" y="0" width="60" height="14" forecolor="#FFFFFF" uuid="ca20cf33-bf94-4df8-a9cc-150c9177bb74">
								<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
								<property name="net.sf.jasperreports.export.xls.auto.fit.row" value="true"/>
							</reportElement>
							<textFieldExpression><![CDATA[$V{CNT_MEASURE1}]]></textFieldExpression>
						</textField>
						<textField isBlankWhenNull="true">
							<reportElement positionType="Float" x="0" y="14" width="60" height="14" forecolor="#FFFFFF" uuid="6fa5956e-eef4-4824-84ec-ab6eed565db5">
								<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
								<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
								<property name="net.sf.jasperreports.export.xls.auto.fit.row" value="true"/>
							</reportElement>
							<textFieldExpression><![CDATA[$V{UET_SUM_MEASURE1}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
				<crosstabCell width="60" height="28" rowTotalGroup="CUSTOM_GR1" columnTotalGroup="RES_GR1">
					<cellContents mode="Opaque" style="Crosstab 4_CT">
						<textField isBlankWhenNull="true">
							<reportElement stretchType="RelativeToBandHeight" x="0" y="0" width="60" height="14" forecolor="#FFFFFF" uuid="e06cb79e-bb9d-4547-a6e4-d864a8acab3c"/>
							<textFieldExpression><![CDATA[$V{CNT_MEASURE1}]]></textFieldExpression>
						</textField>
						<textField isBlankWhenNull="true">
							<reportElement positionType="Float" x="0" y="14" width="60" height="14" forecolor="#FFFFFF" uuid="1d1759e6-4ad9-4b7d-bee7-21d59ae7b470"/>
							<textFieldExpression><![CDATA[$V{UET_SUM_MEASURE1}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
				<crosstabCell width="60" height="28" rowTotalGroup="CUSTOM_GR1" columnTotalGroup="COL_NAME1">
					<cellContents mode="Opaque" style="Crosstab 4_CT">
						<textField isBlankWhenNull="true">
							<reportElement stretchType="RelativeToBandHeight" x="0" y="0" width="60" height="14" forecolor="#FFFFFF" uuid="4d3b8801-6030-4eeb-acda-709bb0cee1fb"/>
							<textFieldExpression><![CDATA[$V{CNT_MEASURE1}]]></textFieldExpression>
						</textField>
						<textField isBlankWhenNull="true">
							<reportElement positionType="Float" x="0" y="14" width="60" height="14" forecolor="#FFFFFF" uuid="c653eaed-bb8e-463b-9bf5-049c94d0e8b4"/>
							<textFieldExpression><![CDATA[$V{UET_SUM_MEASURE1}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
				<crosstabCell width="60" height="28" rowTotalGroup="ROW_NAME1">
					<cellContents mode="Opaque" style="Crosstab 4_CG">
						<textField isBlankWhenNull="true">
							<reportElement stretchType="RelativeToBandHeight" x="0" y="0" width="60" height="14" isRemoveLineWhenBlank="true" uuid="7dae5f95-4d03-452a-9aa8-cbdd7bfa2b38">
								<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
								<property name="net.sf.jasperreports.export.xls.auto.fit.row" value="true"/>
							</reportElement>
							<textFieldExpression><![CDATA[$V{CNT_MEASURE1}]]></textFieldExpression>
						</textField>
						<textField isBlankWhenNull="true">
							<reportElement positionType="Float" x="0" y="14" width="60" height="14" isRemoveLineWhenBlank="true" uuid="6d6ee752-549e-4b14-ae26-cf59070917f6">
								<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
								<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
								<property name="net.sf.jasperreports.export.xls.auto.fit.row" value="true"/>
							</reportElement>
							<textFieldExpression><![CDATA[$V{UET_SUM_MEASURE1}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
				<crosstabCell width="60" height="28" rowTotalGroup="ROW_NAME1" columnTotalGroup="RES_GR1">
					<cellContents mode="Opaque" style="Crosstab 4_CT">
						<textField isBlankWhenNull="true">
							<reportElement stretchType="RelativeToBandHeight" x="0" y="0" width="60" height="14" forecolor="#FFFFFF" uuid="20a6e91b-d25b-48c4-a9e4-426f8584fc21"/>
							<textFieldExpression><![CDATA[$V{CNT_MEASURE1}]]></textFieldExpression>
						</textField>
						<textField isBlankWhenNull="true">
							<reportElement positionType="Float" x="0" y="14" width="60" height="14" forecolor="#FFFFFF" uuid="22e68743-efd7-4d7d-bcd7-b97efb8da3f5"/>
							<textFieldExpression><![CDATA[$V{UET_SUM_MEASURE1}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
				<crosstabCell width="60" height="28" rowTotalGroup="ROW_NAME1" columnTotalGroup="COL_NAME1">
					<cellContents mode="Opaque" style="Crosstab 4_CG">
						<textField isBlankWhenNull="true">
							<reportElement stretchType="RelativeToBandHeight" x="0" y="0" width="60" height="14" isRemoveLineWhenBlank="true" uuid="7afbf743-0410-4a72-a9eb-550df3eed966"/>
							<textFieldExpression><![CDATA[$V{CNT_MEASURE1}]]></textFieldExpression>
						</textField>
						<textField isBlankWhenNull="true">
							<reportElement positionType="Float" x="0" y="14" width="60" height="14" isRemoveLineWhenBlank="true" uuid="86e98155-46f8-450e-b228-b157dc844801"/>
							<textFieldExpression><![CDATA[$V{UET_SUM_MEASURE1}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
			</crosstab>
		</band>
		<band height="1">
			<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
			<printWhenExpression><![CDATA[$V{NUM_ROWS} > 0]]></printWhenExpression>
			<break>
				<reportElement x="0" y="0" width="802" height="1" uuid="8f076e99-239b-4865-8718-1f71418d3ea8">
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
				</reportElement>
			</break>
		</band>
	</detail>
</jasperReport>
